<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.unifs.sdbst.app.dao.primary.life.health.HealthTableMapper" >
  <resultMap id="BaseResultMap" type="com.unifs.sdbst.app.bean.life.health.HealthTable" >
    <result column="SYSTEMID" property="systemid" jdbcType="VARCHAR" />
    <result column="TOWN_ID" property="townId" jdbcType="VARCHAR" />
    <result column="TOWN_NAME" property="townName" jdbcType="VARCHAR" />
    <result column="SITE_ID" property="siteId" jdbcType="VARCHAR" />
    <result column="SITE_NAME" property="siteName" jdbcType="VARCHAR" />
    <result column="CAR_NUMBER" property="carNumber" jdbcType="VARCHAR" />
    <result column="NAME" property="name" jdbcType="VARCHAR" />
    <result column="PHONE" property="phone" jdbcType="VARCHAR" />
    <result column="ID_CARD" property="idCard" jdbcType="VARCHAR" />
    <result column="AGE" property="age" jdbcType="VARCHAR" />
    <result column="SEX" property="sex" jdbcType="VARCHAR" />
    <result column="FROM_HUBEI" property="fromHubei" jdbcType="VARCHAR" />
    <result column="FROM_WENZHOU" property="fromWenzhou" jdbcType="VARCHAR" />
    <result column="FROM_DATE" property="fromDate" jdbcType="TIMESTAMP" />
    <result column="CLOSE_PERSON" property="closePerson" jdbcType="VARCHAR" />
    <result column="ADDRESS" property="address" jdbcType="VARCHAR" />
    <result column="TEMPERATURE" property="temperature" jdbcType="VARCHAR" />
    <result column="OTHER_NAME" property="otherName" jdbcType="VARCHAR" />
    <result column="OTHER_PHONE" property="otherPhone" jdbcType="VARCHAR" />
    <result column="CHARGE_SD" property="chargeSd" jdbcType="VARCHAR" />
    <result column="STREET" property="street" jdbcType="VARCHAR" />
    <result column="COUNTRY" property="country" jdbcType="VARCHAR" />
    <result column="SCHOOL" property="school" jdbcType="VARCHAR" />
    <result column="CONTACT_PERSON" property="contactPerson" jdbcType="VARCHAR" />
    <result column="CONTACT_PHONE" property="contactPhone" jdbcType="VARCHAR" />
    <result column="CONTENT" property="content" jdbcType="VARCHAR" />
    <result column="INSERT_DATE" property="insertDate" jdbcType="TIMESTAMP" />
    <result column="AUTHORIZATION" property="authorization" jdbcType="VARCHAR" />
    <result column="TIMESTAMP" property="timestamp" jdbcType="VARCHAR" />
    <result column="COL1" property="col1" jdbcType="VARCHAR" />
    <result column="COL2" property="col2" jdbcType="VARCHAR" />
    <result column="COL3" property="col3" jdbcType="VARCHAR" />
    <result column="DATE1" property="date1" jdbcType="TIMESTAMP" />
    <result column="DATE2" property="date2" jdbcType="TIMESTAMP" />
    <result column="DATE3" property="date3" jdbcType="TIMESTAMP" />
    <result column="SCHOOL_TYPE" property="schoolType" jdbcType="VARCHAR" />
    <result column="SCCJSJ" property="sccjsj" jdbcType="TIMESTAMP" />
    <result column="TXRQ" property="txrq" jdbcType="TIMESTAMP" />
    <result column="ZJZL" property="zjzl" jdbcType="VARCHAR" />
    <result column="MZ" property="mz" jdbcType="VARCHAR" />
    <result column="OPERMEASURE" property="opermeasure" jdbcType="VARCHAR" />
    <result column="JCS1" property="jcs1" jdbcType="VARCHAR" />
    <result column="JCS1XXQK" property="jcs1xxqk" jdbcType="VARCHAR" />
    <result column="JCS2" property="jcs2" jdbcType="VARCHAR" />
    <result column="JCS2XXQK" property="jcs2xxqk" jdbcType="VARCHAR" />
    <result column="SFFR" property="sffr" jdbcType="VARCHAR" />
    <result column="ZGTW" property="zgtw" jdbcType="VARCHAR" />
    <result column="SFQTZZ" property="sfqtzz" jdbcType="VARCHAR" />
    <result column="SFGRBD" property="sfgrbd" jdbcType="VARCHAR" />
    <result column="QTZZXL" property="qtzzxl" jdbcType="VARCHAR" />
    <result column="GJCLCS" property="gjclcs" jdbcType="VARCHAR" />
    <result column="RQ1" property="rq1" jdbcType="TIMESTAMP" />
    <result column="HSD1" property="hsd1" jdbcType="VARCHAR" />
    <result column="JSD1" property="jsd1" jdbcType="VARCHAR" />
    <result column="JSR1LXDH" property="jsr1lxdh" jdbcType="VARCHAR" />
    <result column="JSR1XM" property="jsr1xm" jdbcType="VARCHAR" />
    <result column="RQ2" property="rq2" jdbcType="TIMESTAMP" />
    <result column="HSD2" property="hsd2" jdbcType="VARCHAR" />
    <result column="JSD2" property="jsd2" jdbcType="VARCHAR" />
    <result column="JSR2XM" property="jsr2xm" jdbcType="VARCHAR" />
    <result column="JSR2LXDH" property="jsr2lxdh" jdbcType="VARCHAR" />
    <result column="YSJSDW" property="ysjsdw" jdbcType="VARCHAR" />
    <result column="GH" property="gh" jdbcType="VARCHAR" />
    <result column="YSJSR" property="ysjsr" jdbcType="VARCHAR" />
    <result column="CPH" property="cph" jdbcType="VARCHAR" />
    <result column="JSRLXFS" property="jsrlxfs" jdbcType="VARCHAR" />
    <result column="YWRYQM" property="ywryqm" jdbcType="VARCHAR" />
    <result column="YWRYDH" property="ywrydh" jdbcType="VARCHAR" />
    <result column="DBMJQM" property="dbmjqm" jdbcType="VARCHAR" />
    <result column="ZBMJDH" property="zbmjdh" jdbcType="VARCHAR" />
    <result column="ZBMJQRRQ" property="zbmjqrrq" jdbcType="TIMESTAMP" />
    <result column="SFBH" property="sfbh" jdbcType="VARCHAR" />
    <result column="BZ" property="bz" jdbcType="VARCHAR" />
    <result column="ZXZT" property="zxzt" jdbcType="VARCHAR" />
    <result column="DJSJ" property="djsj" jdbcType="TIMESTAMP" />
    <result column="XGSJ" property="xgsj" jdbcType="TIMESTAMP" />
    <result column="DJR_ID" property="djrId" jdbcType="VARCHAR" />
    <result column="XGR_ID" property="xgrId" jdbcType="VARCHAR" />
    <result column="CFD" property="cfd" jdbcType="VARCHAR" />
    <result column="MDD" property="mdd" jdbcType="VARCHAR" />
    <result column="APP_CODE" property="appCode" jdbcType="VARCHAR" />
    <result column="APP_NAME" property="appName" jdbcType="VARCHAR" />
    <result column="REMARK1" property="remark1" jdbcType="VARCHAR" />
    <result column="REMARK2" property="remark2" jdbcType="VARCHAR" />
    <result column="REMARK3" property="remark3" jdbcType="VARCHAR" />
    <result column="REMARK4" property="remark4" jdbcType="VARCHAR" />
    <result column="REMARK5" property="remark5" jdbcType="VARCHAR" />
    <result column="REMARK6" property="remark6" jdbcType="VARCHAR" />
    <result column="REMARK7" property="remark7" jdbcType="VARCHAR" />
    <result column="REMARK8" property="remark8" jdbcType="VARCHAR" />
    <result column="REMARK9" property="remark9" jdbcType="VARCHAR" />
    <result column="REMARK10" property="remark10" jdbcType="VARCHAR" />
    <result column="REMARK11" property="remark11" jdbcType="VARCHAR" />
    <result column="REMARK12" property="remark12" jdbcType="VARCHAR" />
    <result column="REMARK13" property="remark13" jdbcType="VARCHAR" />
    <result column="REMARK14" property="remark14" jdbcType="VARCHAR" />
    <result column="REMARK15" property="remark15" jdbcType="VARCHAR" />
    <result column="REMARK_DATE1" property="remarkDate1" jdbcType="TIMESTAMP" />
    <result column="REMARK_DATE2" property="remarkDate2" jdbcType="TIMESTAMP" />
    <result column="REMARK_DATE3" property="remarkDate3" jdbcType="TIMESTAMP" />
    <result column="REMARK_DATE4" property="remarkDate4" jdbcType="TIMESTAMP" />
    <result column="REMARK_DATE5" property="remarkDate5" jdbcType="TIMESTAMP" />
    <result column="ZZSBSJ" property="zzsbsj" jdbcType="TIMESTAMP" />
    <result column="RYLB" property="rylb" jdbcType="VARCHAR" />
    <result column="LHJYZDLX" property="lhjyzdlx" jdbcType="VARCHAR" />
  </resultMap>
  <insert id="insert" parameterType="com.unifs.sdbst.app.bean.life.health.HealthTable" >
    insert into APP_POLICE_CHECK (SYSTEMID, TOWN_ID, TOWN_NAME, 
      SITE_ID, SITE_NAME, CAR_NUMBER, 
      NAME, PHONE, ID_CARD, 
      AGE, SEX, FROM_HUBEI, 
      FROM_WENZHOU, FROM_DATE, CLOSE_PERSON, 
      ADDRESS, TEMPERATURE, OTHER_NAME, 
      OTHER_PHONE, CHARGE_SD, STREET, 
      COUNTRY, SCHOOL, CONTACT_PERSON, 
      CONTACT_PHONE, CONTENT, INSERT_DATE, 
      AUTHORIZATION, TIMESTAMP, COL1, 
      COL2, COL3, DATE1, 
      DATE2, DATE3, SCHOOL_TYPE, 
      SCCJSJ, TXRQ, ZJZL, 
      MZ, OPERMEASURE, JCS1, 
      JCS1XXQK, JCS2, JCS2XXQK, 
      SFFR, ZGTW, SFQTZZ, 
      SFGRBD, QTZZXL, GJCLCS, 
      RQ1, HSD1, JSD1, 
      JSR1LXDH, JSR1XM, RQ2, 
      HSD2, JSD2, JSR2XM, 
      JSR2LXDH, YSJSDW, GH, 
      YSJSR, CPH, JSRLXFS, 
      YWRYQM, YWRYDH, DBMJQM, 
      ZBMJDH, ZBMJQRRQ, SFBH, 
      BZ, ZXZT, DJSJ, XGSJ, 
      DJR_ID, XGR_ID, CFD, 
      MDD, APP_CODE, APP_NAME, 
      REMARK1, REMARK2, REMARK3, 
      REMARK4, REMARK5, REMARK6, 
      REMARK7, REMARK8, REMARK9, 
      REMARK10, REMARK11, REMARK12, 
      REMARK13, REMARK14, REMARK15, 
      REMARK_DATE1, REMARK_DATE2, REMARK_DATE3, 
      REMARK_DATE4, REMARK_DATE5, ZZSBSJ, 
      RYLB, LHJYZDLX)
    values (#{systemid,jdbcType=VARCHAR}, #{townId,jdbcType=VARCHAR}, #{townName,jdbcType=VARCHAR}, 
      #{siteId,jdbcType=VARCHAR}, #{siteName,jdbcType=VARCHAR}, #{carNumber,jdbcType=VARCHAR}, 
      #{name,jdbcType=VARCHAR}, #{phone,jdbcType=VARCHAR}, #{idCard,jdbcType=VARCHAR}, 
      #{age,jdbcType=VARCHAR}, #{sex,jdbcType=VARCHAR}, #{fromHubei,jdbcType=VARCHAR}, 
      #{fromWenzhou,jdbcType=VARCHAR}, #{fromDate,jdbcType=TIMESTAMP}, #{closePerson,jdbcType=VARCHAR}, 
      #{address,jdbcType=VARCHAR}, #{temperature,jdbcType=VARCHAR}, #{otherName,jdbcType=VARCHAR}, 
      #{otherPhone,jdbcType=VARCHAR}, #{chargeSd,jdbcType=VARCHAR}, #{street,jdbcType=VARCHAR}, 
      #{country,jdbcType=VARCHAR}, #{school,jdbcType=VARCHAR}, #{contactPerson,jdbcType=VARCHAR}, 
      #{contactPhone,jdbcType=VARCHAR}, #{content,jdbcType=VARCHAR}, #{insertDate,jdbcType=TIMESTAMP}, 
      #{authorization,jdbcType=VARCHAR}, #{timestamp,jdbcType=VARCHAR}, #{col1,jdbcType=VARCHAR}, 
      #{col2,jdbcType=VARCHAR}, #{col3,jdbcType=VARCHAR}, #{date1,jdbcType=TIMESTAMP}, 
      #{date2,jdbcType=TIMESTAMP}, #{date3,jdbcType=TIMESTAMP}, #{schoolType,jdbcType=VARCHAR}, 
      #{sccjsj,jdbcType=TIMESTAMP}, #{txrq,jdbcType=TIMESTAMP}, #{zjzl,jdbcType=VARCHAR}, 
      #{mz,jdbcType=VARCHAR}, #{opermeasure,jdbcType=VARCHAR}, #{jcs1,jdbcType=VARCHAR}, 
      #{jcs1xxqk,jdbcType=VARCHAR}, #{jcs2,jdbcType=VARCHAR}, #{jcs2xxqk,jdbcType=VARCHAR}, 
      #{sffr,jdbcType=VARCHAR}, #{zgtw,jdbcType=VARCHAR}, #{sfqtzz,jdbcType=VARCHAR}, 
      #{sfgrbd,jdbcType=VARCHAR}, #{qtzzxl,jdbcType=VARCHAR}, #{gjclcs,jdbcType=VARCHAR}, 
      #{rq1,jdbcType=TIMESTAMP}, #{hsd1,jdbcType=VARCHAR}, #{jsd1,jdbcType=VARCHAR}, 
      #{jsr1lxdh,jdbcType=VARCHAR}, #{jsr1xm,jdbcType=VARCHAR}, #{rq2,jdbcType=TIMESTAMP}, 
      #{hsd2,jdbcType=VARCHAR}, #{jsd2,jdbcType=VARCHAR}, #{jsr2xm,jdbcType=VARCHAR}, 
      #{jsr2lxdh,jdbcType=VARCHAR}, #{ysjsdw,jdbcType=VARCHAR}, #{gh,jdbcType=VARCHAR}, 
      #{ysjsr,jdbcType=VARCHAR}, #{cph,jdbcType=VARCHAR}, #{jsrlxfs,jdbcType=VARCHAR}, 
      #{ywryqm,jdbcType=VARCHAR}, #{ywrydh,jdbcType=VARCHAR}, #{dbmjqm,jdbcType=VARCHAR}, 
      #{zbmjdh,jdbcType=VARCHAR}, #{zbmjqrrq,jdbcType=TIMESTAMP}, #{sfbh,jdbcType=VARCHAR}, 
      #{bz,jdbcType=VARCHAR}, #{zxzt,jdbcType=VARCHAR}, #{djsj,jdbcType=TIMESTAMP}, #{xgsj,jdbcType=TIMESTAMP}, 
      #{djrId,jdbcType=VARCHAR}, #{xgrId,jdbcType=VARCHAR}, #{cfd,jdbcType=VARCHAR}, 
      #{mdd,jdbcType=VARCHAR}, #{appCode,jdbcType=VARCHAR}, #{appName,jdbcType=VARCHAR}, 
      #{remark1,jdbcType=VARCHAR}, #{remark2,jdbcType=VARCHAR}, #{remark3,jdbcType=VARCHAR}, 
      #{remark4,jdbcType=VARCHAR}, #{remark5,jdbcType=VARCHAR}, #{remark6,jdbcType=VARCHAR}, 
      #{remark7,jdbcType=VARCHAR}, #{remark8,jdbcType=VARCHAR}, #{remark9,jdbcType=VARCHAR}, 
      #{remark10,jdbcType=VARCHAR}, #{remark11,jdbcType=VARCHAR}, #{remark12,jdbcType=VARCHAR}, 
      #{remark13,jdbcType=VARCHAR}, #{remark14,jdbcType=VARCHAR}, #{remark15,jdbcType=VARCHAR}, 
      #{remarkDate1,jdbcType=TIMESTAMP}, #{remarkDate2,jdbcType=TIMESTAMP}, #{remarkDate3,jdbcType=TIMESTAMP}, 
      #{remarkDate4,jdbcType=TIMESTAMP}, #{remarkDate5,jdbcType=TIMESTAMP}, #{zzsbsj,jdbcType=TIMESTAMP}, 
      #{rylb,jdbcType=VARCHAR}, #{lhjyzdlx,jdbcType=VARCHAR})
  </insert>
<!--  <select id="selectAll" resultMap="BaseResultMap" >-->
<!--    select SYSTEMID, TOWN_ID, TOWN_NAME, SITE_ID, SITE_NAME, CAR_NUMBER, NAME, PHONE, -->
<!--    ID_CARD, AGE, SEX, FROM_HUBEI, FROM_WENZHOU, FROM_DATE, CLOSE_PERSON, ADDRESS, TEMPERATURE, -->
<!--    OTHER_NAME, OTHER_PHONE, CHARGE_SD, STREET, COUNTRY, SCHOOL, CONTACT_PERSON, CONTACT_PHONE, -->
<!--    CONTENT, INSERT_DATE, AUTHORIZATION, TIMESTAMP, COL1, COL2, COL3, DATE1, DATE2, DATE3, -->
<!--    SCHOOL_TYPE, SCCJSJ, TXRQ, ZJZL, MZ, OPERMEASURE, JCS1, JCS1XXQK, JCS2, JCS2XXQK, -->
<!--    SFFR, ZGTW, SFQTZZ, SFGRBD, QTZZXL, GJCLCS, RQ1, HSD1, JSD1, JSR1LXDH, JSR1XM, RQ2, -->
<!--    HSD2, JSD2, JSR2XM, JSR2LXDH, YSJSDW, GH, YSJSR, CPH, JSRLXFS, YWRYQM, YWRYDH, DBMJQM, -->
<!--    ZBMJDH, ZBMJQRRQ, SFBH, BZ, ZXZT, DJSJ, XGSJ, DJR_ID, XGR_ID, CFD, MDD, APP_CODE, -->
<!--    APP_NAME, REMARK1, REMARK2, REMARK3, REMARK4, REMARK5, REMARK6, REMARK7, REMARK8, -->
<!--    REMARK9, REMARK10, REMARK11, REMARK12, REMARK13, REMARK14, REMARK15, REMARK_DATE1, -->
<!--    REMARK_DATE2, REMARK_DATE3, REMARK_DATE4, REMARK_DATE5, ZZSBSJ, RYLB, LHJYZDLX-->
<!--    from APP_POLICE_CHECK-->
<!--  </select>-->

  <select id="selectByjiaotong" resultType="java.util.Map">
    select types 类别,sum(case when substr(id_card,0,2) = '42' then 1
    when substr(id_card,0,2) != '42' and from_hubei = '是' then 1
    when opermeasure='酒店集中隔离' and from_wenzhou = '否' and from_hubei = '否' then 1
    else 0 end ) as numfromhubei,
    sum(case when substr(id_card,0,4) = '3303' then 1
    when substr(id_card,0,4) != '3303' and from_wenzhou = '是'  then 1
    else 0 end ) as numfromwenzhou,
    sum(case when (case when trim(translate(temperature, '0123456789.', ' ')) is null then  temperature  else null end) >37.3 then 1
    else 0 end) numhot,
    sum(case when (case when trim(translate(temperature, '0123456789.', ' ')) is null then  temperature  else null end) >37.3 and from_hubei = '是' then 1
    else 0 end) numhothubei,
    sum(case when (case when trim(translate(temperature, '0123456789.', ' ')) is null then  temperature  else null end) >37.3 and from_wenzhou = '是' then 1
    else 0 end) numhotweizhou,
    sum(case when (case when trim(translate(temperature, '0123456789.', ' ')) is null then  temperature  else null end) >37.3
    and from_wenzhou = '否' and from_hubei = '否' then 1
    else 0 end) numhotother,
    sum(case when opermeasure='酒店集中隔离' then 1
    else 0 end) isolationhotel,
    sum(case when opermeasure='酒店集中隔离' and from_hubei = '是' then 1
    else 0 end) isolationhotehubei,
    sum(case when opermeasure='酒店集中隔离' and from_wenzhou = '是'then 1
    else 0 end) isolationhoteweizhou ,
    sum(case when opermeasure='酒店集中隔离' and from_wenzhou = '是' and from_wenzhou = '否' and from_hubei = '否' then 1
    else 0 end) isolationhoteother
    from  app_police_check a ,site_type_record b
    where a.site_id(+) = b.sid
    and djsj &gt; (TRUNC(SYSDATE)+ 21/24)-1
    and djsj &lt; (TRUNC(SYSDATE)+ 21/24)
    group by b.types order by b.types
  </select>

  <select id="selectByHubei" resultType="java.util.Map">
    select b.sorts 镇街,b.names 站点,sum(case when substr(id_card,0,2) = '42' then 1
    else 0 end ) as 湖北籍人数,
    sum(case when (substr(id_card,0,2) = '42' and opermeasure='酒店集中隔离') then 1
    else 0 end ) as 酒店集中隔离,
    sum(case when (substr(id_card,0,2) = '42' and opermeasure='转送定点医院') then 1
    else 0 end ) as 转送定点医院,
    sum(case when (substr(id_card,0,2) = '42' and opermeasure='社区居家隔离') then 1
    else 0 end ) as 社区居家隔离,
    sum(case when (substr(id_card,0,2) = '42' and opermeasure='过境、离境及劝返') then 1
    else 0 end ) as 过境离境及劝返,
    sum(case when (substr(id_card,0,2) = '42' and opermeasure='放行') then 1
    else 0 end ) as 放行,
    sum(case when (substr(id_card,0,2) = '42' and opermeasure is null) then 1
    else 0 end ) as 待核查,
    sum(case when substr(id_card,0,4) = '3303' then 1
    else 0 end ) as 温州籍人数,
    sum(case when (substr(id_card,0,4) = '3303' and opermeasure='酒店集中隔离') then 1
    else 0 end ) as 酒店集中隔离,
    sum(case when (substr(id_card,0,4) = '3303' and opermeasure='转送定点医院') then 1
    else 0 end ) as 转送定点医院,
    sum(case when (substr(id_card,0,4) = '3303' and opermeasure='社区居家隔离') then 1
    else 0 end ) as 社区居家隔离,
    sum(case when (substr(id_card,0,4) = '3303' and opermeasure='过境、离境及劝返') then 1
    else 0 end ) as 过境离境及劝返,
    sum(case when (substr(id_card,0,4) = '3303' and opermeasure='放行') then 1
    else 0 end ) as 放行,
    sum(case when (substr(id_card,0,4) = '3303' and opermeasure is null) then 1
    else 0 end ) as 待核查  from app_police_check a ,site_type_record b
    where a.site_id(+) = b.sid
     and djsj &gt; (TRUNC(SYSDATE)+ 21/24)-1
    and djsj &lt; (TRUNC(SYSDATE)+ 21/24)
    group by b.sorts,b.names order by b.sorts
  </select>
  <select id="selectBihuan" resultType="java.util.Map" >
    select  b.sorts 镇街,b.names 站点,count(0) 总数,sum(case when opermeasure is not null then 1 else 0 end) 闭环,
    case when count(0) != 0 then round(sum(case when opermeasure is not null then 1 else 0 end)*100/count(0) ,2)||'%' else 0||'%' end 闭环率,
    sum(case when opermeasure is null then 1 else 0 end) 未闭环,
    case when count(0) != 0 then round(sum(case when opermeasure is null then 1 else 0 end)*100/count(0) ,2)||'%' else 0||'%' end  未闭环率 from  app_police_check a ,site_type_record b
    where a.site_id(+) = b.sid and
     djsj &gt; (TRUNC(SYSDATE)+ 21/24)-1
    and djsj &lt; (TRUNC(SYSDATE)+ 21/24)
    group by b.sorts,b.names order by b.sorts
  </select>
</mapper>